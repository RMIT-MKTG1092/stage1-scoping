<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Stage-1 Scoping Worksheet – LaundryMax</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
 body{font-family:Arial,Helvetica,sans-serif;line-height:1.5;margin:40px auto;max-width:960px;color:#222;}
 h1{color:#ba372a;font-size:1.9rem;margin-bottom:.45em;}
 h2{color:#ba372a;font-size:1.35rem;margin-top:2.1em;margin-bottom:.55em;}
 h3{color:#000054;font-size:1.05rem;margin-top:1.6em;margin-bottom:.45em;}

 table{border-collapse:collapse;width:100%;margin:12px 0;font-size:.93rem;}
 th,td{border:1px solid #ccc;padding:6px 8px;vertical-align:top;}
 th{background:#f0f0f0;}

 textarea,input[type=text],input[type=number]{
  width:100%;padding:6px;border:1px solid #bbb;border-radius:4px;
  font-family:inherit;font-size:.92rem;box-sizing:border-box;}
 textarea{min-height:64px;}
 input[type=number]{-moz-appearance:textfield;}
 input[type=number]::-webkit-inner-spin-button,
 input[type=number]::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;}

 ::placeholder{color:#888;}
 .smallnote{font-size:.83rem;color:#666;}
 .scan-box{width:100%;min-height:64px;padding:6px;border:1px solid #bbb;border-radius:4px;font-size:.92rem;}
 .scan-score{width:55px;text-align:center;padding:4px;border:1px solid #bbb;border-radius:4px;}
 .force-score{width:65px;text-align:center;background:#f8f8f8;font-weight:600;}
 .export-btn{display:inline-block;background:#ba372a;color:#fff;border:none;padding:10px 22px;border-radius:4px;font-size:1rem;cursor:pointer;margin-top:22px;}
 .export-btn:hover{background:#a12e1f;}
</style>
</head>

<body>
<div id="worksheet">

<h1>Stage-Gate® Stage 1 Worksheet – LaundryMax Co.</h1>
<p><strong>How to use.</strong> Fill each section (grey placeholders guide you). When done, click
<strong>“Export to Word”</strong> or use Print → PDF.</p>
<hr>

<!-- Snapshot, External Scan and Rough-Cut Numbers sections unchanged -->
<!-- …(omitted here for brevity – identical to previous file)… -->

<!-- 4. Gate Decision -->
<h2>Gate Decision</h2>

<h3>Should-meet scorecard</h3>
<table>
 <thead><tr>
   <th style="width:28%">Criterion (score 1-5)</th>
   <th style="width:8%">Score</th>
   <th style="width:32%">Justification<br><span class="smallnote">(why you selected this score—2-3 sentences)</span></th>
   <th>Source<br><span class="smallnote">(data, URL, report, stakeholder quote)</span></th>
 </tr></thead>
 <tbody>
  <tr>
    <td>Competitive advantage potential</td>
    <td><input type="number" min="1" max="5" class="sm-score scan-score"></td>
    <td><textarea class="scan-box" placeholder="Unique IP + switching cost gives 4/5."></textarea></td>
    <td><textarea class="scan-box" placeholder="Patent search; Gartner market trends 2024."></textarea></td>
  </tr>
  <tr>
    <td>Leverages key capabilities / creates synergy</td>
    <td><input type="number" min="1" max="5" class="sm-score scan-score"></td>
    <td><textarea class="scan-box" placeholder="Uses existing IoT stack, production lines."></textarea></td>
    <td><textarea class="scan-box" placeholder="Ops capability audit; CTO interview."></textarea></td>
  </tr>
  <tr>
    <td>Market size and growth justify next stage</td>
    <td><input type="number" min="1" max="5" class="sm-score scan-score"></td>
    <td><textarea class="scan-box" placeholder="SAM $120 m growing 8 % CAGR ⇒ 5/5."></textarea></td>
    <td><textarea class="scan-box" placeholder="IBISWorld Laundry Services 2024."></textarea></td>
  </tr>
  <tr>
    <td>Regulatory / environmental fit (no show-stoppers)</td>
    <td><input type="number" min="1" max="5" class="sm-score scan-score"></td>
    <td><textarea class="scan-box" placeholder="Meets water-use code; minor EPA paperwork."></textarea></td>
    <td><textarea class="scan-box" placeholder="EPA fact sheet; legal counsel memo."></textarea></td>
  </tr>
 </tbody>
</table>

<p style="max-width:320px;"><label><strong>Average “should-meet” score</strong>
<input id="avgScore" type="number" step="0.1" min="1" max="5" class="scan-score" style="width:90px;" readonly></label></p>

<h3 class="tcentre">Verdict</h3>
<table style="width:70%;margin:auto;"><tbody>
  <tr><td><label><input type="checkbox"> <span style="color:#027634;font-weight:600;">Go</span> — evidence is compelling</label></td></tr>
  <tr><td><label><input type="checkbox"> Hold — needs more data</label></td></tr>
  <tr><td><label><input type="checkbox"> <span style="color:#c0392b;font-weight:600;">Kill</span> — fails must-meet</label></td></tr>
</tbody></table>

<p><textarea placeholder="Explain your decision (up to 200 words)." style="min-height:120px;"></textarea></p>
<p class="smallnote tcentre">Remember to Export or Print before closing.</p>

<button class="export-btn" id="exportWord">Export to Word</button>
</div><!-- /worksheet -->

<script>
/* ⤵ scripts identical to previous version: comma-format, SAM/SOM maths, force averages, should-meet average, Word export ⤵ */

/* comma-format helper */
function fmtComma(el){
 const raw=el.value.replace(/[^0-9.]/g,'');
 if(!raw){el.value='';return;}
 const p=raw.split('.');p[0]=p[0].replace(/\B(?=(\d{3})+(?!\d))/g,',');
 el.value=(el.value.trim().charAt(0)==='$'?'$ ':'')+p.join('.');
}
['tamValue','samValue','somValue','cacValue','clvValue','npvValue','devCost']
  .forEach(id=>{const e=document.getElementById(id); if(e){e.addEventListener('blur',e=>fmtComma(e.target));}});

/* SAM & SOM auto-calc */
function calcSAM(){const t=+tamValue.value.replace(/[^0-9.]/g,'')||0;
 const p=+samPercent.value||0;
 samValue.value=t&&p? (t*p/100).toLocaleString():'';}
function calcSOM(){const s=+samValue.value.replace(/[^0-9.]/g,'')||0;
 const p=+somPercent.value||0;
 somValue.value=s&&p? (s*p/100).toLocaleString():'';}
if(window.tamValue){
 tamValue.addEventListener('blur',calcSAM);samPercent.addEventListener('input',calcSAM);
 samPercent.addEventListener('blur',calcSOM);somPercent.addEventListener('input',calcSOM);
}

/* Five-Forces averages */
const map={new:'force_new',sup:'force_sup',buy:'force_buy',sub:'force_sub',riv:'force_riv'};
function updForces(){
 Object.keys(map).forEach(key=>{
  const vals=[...document.querySelectorAll(`input.var-score[data-force=${key}]`)]
    .map(i=>+i.value||0).filter(v=>v);
  document.getElementById(map[key]).value=vals.length?(vals.reduce((a,b)=>a+b)/vals.length).toFixed(2):'';
 });
}
document.querySelectorAll('input.var-score').forEach(i=>i.addEventListener('input',updForces));

/* auto-average should-meet */
function avgSM(){
 const vals=[...document.querySelectorAll('.sm-score')].map(i=>+i.value||0).filter(v=>v);
 avgScore.value=vals.length?(vals.reduce((a,b)=>a+b)/vals.length).toFixed(2):'';
}
document.querySelectorAll('.sm-score').forEach(i=>i.addEventListener('input',avgSM));

/* Word export */
exportWord.addEventListener('click',()=>{
 const html=`<html xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:w="urn:schemas-microsoft-com:office:word"
  xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="utf-8">
  <style>body{font-family:Arial,Helvetica,sans-serif;}</style></head><body>`
  +document.getElementById('worksheet').innerHTML+'</body></html>';
 const blob=new Blob(['\uFEFF',html],{type:'application/msword'});
 const url=URL.createObjectURL(blob);
 const a=document.createElement('a');a.href=url;a.download='Stage1-Worksheet.doc';
 document.body.appendChild(a);a.click();
 setTimeout(()=>{URL.revokeObjectURL(url);a.remove();},0);
});
</script>
</body>
</html>
